<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PFT-X</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body {
  background: radial-gradient(circle at top left, #0b1220, #0f172a);
}

.card-glow {
  background: rgba(30, 41, 59, 0.85);
  backdrop-filter: blur(6px);
  box-shadow: 0 0 25px rgba(59,130,246,0.15);
}

.chart-glow canvas {
  filter: drop-shadow(0px 0px 6px rgba(59,130,246,0.4));
}

.sidebar-active {
  background: rgba(59,130,246,0.15);
  border-left: 3px solid #3b82f6;
}
</style>
</head>

<body class="text-white min-h-screen flex">

<div class="w-64 bg-slate-900 p-6 flex flex-col justify-between shadow-2xl">

  <div>
    <h1 class="text-2xl font-bold">PFT-X</h1>
    <p class="text-sm text-gray-400 mb-6">Personal Financial Tech Intelligence</p>

    <nav class="flex flex-col space-y-3 text-gray-300 text-sm">
      <div class="sidebar-active px-3 py-2 rounded">Dashboard</div>
      <div class="hover:text-white px-3 py-2">Portfolio</div>
      <div class="hover:text-white px-3 py-2">Risk Analytics</div>
      <div class="hover:text-white px-3 py-2">Monte Carlo</div>
      <div class="hover:text-white px-3 py-2">Market News</div>
      <div class="hover:text-white px-3 py-2">Long-Term Tools</div>
      <div class="hover:text-white px-3 py-2">Settings</div>
    </nav>
  </div>

  <div class="text-xs text-gray-500 opacity-70">
    <div>Founder: Jaskaran Daudher</div>
    <div>Financial Structuring: Rohan Khosla</div>
    <div>UI Layout: Callum Appleby</div>
  </div>

</div>

<div class="flex-1 p-8 space-y-8">

  <div class="flex justify-between items-center">
    <div class="flex items-center space-x-2">
      <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
      <span class="text-gray-400 text-sm">Markets Open</span>
    </div>
    <div class="w-20 h-10 bg-gray-200 rounded-md"></div>
  </div>

  <div class="grid grid-cols-4 gap-6">

    <div class="card-glow p-6 rounded-xl">
      <p class="text-gray-400 text-xs">Total Portfolio Value</p>
      <h2 class="text-3xl font-bold mt-2">£10,785.00</h2>
      <p class="text-xs text-gray-500 mt-1">Total portfolio: Today</p>
    </div>

    <div class="card-glow p-6 rounded-xl">
      <p class="text-gray-400 text-xs">Profit / Loss</p>
      <h2 class="text-3xl font-bold mt-2 text-green-400">+£535.00</h2>
      <p class="text-xs text-green-400 mt-1">+5.23%</p>
    </div>

    <div class="card-glow p-6 rounded-xl">
      <p class="text-gray-400 text-xs">Risk Score</p>
      <h2 class="text-3xl font-bold mt-2">62</h2>
      <p class="text-xs text-gray-400 mt-1">Moderate Risk</p>
    </div>

    <div class="card-glow p-6 rounded-xl chart-glow">
      <p class="text-gray-400 text-xs">Volatility %</p>
      <h2 class="text-3xl font-bold mt-2">1.58%</h2>
      <canvas id="miniChart" height="60"></canvas>
    </div>

  </div>

  <div class="grid grid-cols-3 gap-6">

    <div class="card-glow p-6 rounded-xl chart-glow">
      <h3 class="mb-4 font-semibold">Portfolio Allocation</h3>
      <canvas id="pieChart"></canvas>
    </div>

    <div class="card-glow p-6 rounded-xl chart-glow">
      <h3 class="mb-4 font-semibold">Risk Score</h3>
      <canvas id="riskChart"></canvas>
    </div>

    <div class="card-glow p-6 rounded-xl">
      <h3 class="mb-4 font-semibold">AI Insights</h3>
      <div class="text-sm text-gray-300 space-y-3">
        <div class="bg-slate-700 p-3 rounded">Too much volatility detected. Consider selling high-risk assets.</div>
        <div class="bg-slate-700 p-3 rounded">AAPL shows near-term momentum. Consider increasing exposure.</div>
      </div>
    </div>

  </div>

</div>

<script>
new Chart(document.getElementById('miniChart'), {
  type: 'line',
  data: {
    labels: ['','','','','',''],
    datasets: [{
      data: [1.2,1.4,1.1,1.5,1.6,1.58],
      borderColor: '#3b82f6',
      tension: 0.4
    }]
  },
  options:{plugins:{legend:{display:false}},scales:{x:{display:false},y:{display:false}}}
});

new Chart(document.getElementById('pieChart'), {
  type: 'doughnut',
  data: {
    labels: ['AAPL','TSLA','AMZN'],
    datasets: [{
      data: [40,30,30],
      backgroundColor: ['#3b82f6','#f59e0b','#10b981']
    }]
  }
});

new Chart(document.getElementById('riskChart'), {
  type: 'line',
  data: {
    labels: ['Jan','Feb','Mar','Apr','May'],
    datasets: [{
      data: [50,55,60,58,62],
      borderColor: '#3b82f6',
      tension: 0.4
    }]
  }
});
  async function loadLiveData() {
  try {
    const response = await fetch('/api/stock?symbol=AAPL');
    const data = await response.json();

    // Example: assume 40 shares of AAPL
    const shares = 40;

    const portfolioValue = data.current * shares;
    const profit = (data.current - data.previousClose) * shares;

    // Update Total Portfolio Value
    const portfolioElement = document.querySelectorAll("h2")[0];
    portfolioElement.innerText = "£" + portfolioValue.toFixed(2);

    // Update Profit / Loss
    const profitElement = document.querySelectorAll("h2")[1];
    profitElement.innerText =
      (profit >= 0 ? "+" : "") + "£" + profit.toFixed(2);

    profitElement.classList.remove("text-green-400", "text-red-400");

    if (profit >= 0) {
      profitElement.classList.add("text-green-400");
    } else {
      profitElement.classList.add("text-red-400");
    }

    // Update Risk Score (simple demo logic)
    const riskElement = document.querySelectorAll("h2")[2];
    const volatilityPercent =
      Math.abs((data.high - data.low) / data.current) * 100;

    const riskScore = Math.min(100, Math.round(volatilityPercent * 10));
    riskElement.innerText = riskScore;

    // Update Volatility %
    const volElement = document.querySelectorAll("h2")[3];
    volElement.innerText = volatilityPercent.toFixed(2) + "%";

  } catch (error) {
    console.error("Live data failed:", error);
  }
}

loadLiveData();
</script>

</body>
</html>
